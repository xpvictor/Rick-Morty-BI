<h2><p>Power Query of all steps aplied to generate <b>df_character datasource</b></p></h2>

>let
    Source = Python.Execute("import requests#(lf)import json#(lf)import pandas as pd #(lf)#from pyspark.sql.functions import col, explode_outer#(lf)#from pyspark.sql import SparkSession#(lf)#(lf)list_ids = [ids for ids in range(1,101)]#(lf)url = f'https://rickandmortyapi.com/api/character/{list_ids}'#(lf)lista_dados1 = requests.get(url).json()#(lf)#(lf)list_ids = [ids for ids in range(101,201)]#(lf)url = f'https://rickandmortyapi.com/api/character/{list_ids}'#(lf)lista_dados2 = requests.get(url).json()#(lf)#(lf)list_ids = [ids for ids in range(201,301)]#(lf)url = f'https://rickandmortyapi.com/api/character/{list_ids}'#(lf)lista_dados3 = requests.get(url).json()#(lf)#(lf)list_ids = [ids for ids in range(301,401)]#(lf)url = f'https://rickandmortyapi.com/api/character/{list_ids}'#(lf)lista_dados4 = requests.get(url).json()#(lf)#(lf)list_ids = [ids for ids in range(401,501)]#(lf)url = f'https://rickandmortyapi.com/api/character/{list_ids}'#(lf)lista_dados5 = requests.get(url).json()#(lf)#(lf)list_ids = [ids for ids in range(501,601)]#(lf)url = f'https://rickandmortyapi.com/api/character/{list_ids}'#(lf)lista_dados6 = requests.get(url).json()#(lf)#(lf)list_ids = [ids for ids in range(601,701)]#(lf)url = f'https://rickandmortyapi.com/api/character/{list_ids}'#(lf)lista_dados7 = requests.get(url).json()#(lf)#(lf)list_ids = [ids for ids in range(801,827)]#(lf)url = f'https://rickandmortyapi.com/api/character/{list_ids}'#(lf)lista_dados8 = requests.get(url).json()#(lf)#(lf)#Normalizando as informações JSON que estiverem em outras estruturas(objetos, etc.)#(lf)normalized_data1 = pd.json_normalize(lista_dados1)#(lf)normalized_data2 = pd.json_normalize(lista_dados2)#(lf)normalized_data3 = pd.json_normalize(lista_dados3)#(lf)normalized_data4 = pd.json_normalize(lista_dados4)#(lf)normalized_data5 = pd.json_normalize(lista_dados5)#(lf)normalized_data6 = pd.json_normalize(lista_dados6)#(lf)normalized_data7 = pd.json_normalize(lista_dados7)#(lf)normalized_data8 = pd.json_normalize(lista_dados8)#(lf)#(lf)#Criando um dataframe unificado que será utilizado como datasource no projeto de BI#(lf)df_character = pd.concat([#(lf)    normalized_data1,#(lf)    normalized_data1,#(lf)    normalized_data3,#(lf)    normalized_data4,#(lf)    normalized_data5,#(lf)    normalized_data6,#(lf)    normalized_data7,#(lf)    normalized_data8])#(lf)#(lf)# Alterando os registros em brando para unknown#(lf)df_character['type'] = df_character['type'].replace('','unknown')#(lf)#(lf)df_character = df_character.drop_duplicates(subset='id')#(lf)#(lf)"),
    df_character1 = Source{[Name="df_character"]}[Value],
    #"Changed Type" = Table.TransformColumnTypes(df_character1,{{"id", Int64.Type}, {"name", type text}, {"status", type text}, {"species", type text}, {"type", type text}, {"gender", type text}, {"image", type text}, {"episode", type text}, {"url", type text}, {"created", type datetime}, {"origin.name", type text}, {"origin.url", type text}, {"location.name", type text}, {"location.url", type text}})
in
    #"Changed Type"